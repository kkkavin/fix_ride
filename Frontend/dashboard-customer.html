<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | FixRide</title>
    <link rel="icon" type="image/png" href="assets/img/logo.png">
    <link rel="stylesheet" href="assets/css/variables.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <style>
        .status-timeline {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            position: relative;
        }

        .status-timeline::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 2px;
            background: rgba(255, 255, 255, 0.1);
            z-index: -1;
        }

        .status-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            background: var(--color-bg-dark);
            padding: 0 10px;
        }

        .step-dot {
            width: 30px;
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .step-dot.active {
            background: var(--color-success);
            box-shadow: 0 0 10px var(--color-success);
        }

        .step-label {
            font-size: 0.8rem;
            color: var(--color-text-muted);
        }

        .step-label.active {
            color: white;
            font-weight: bold;
        }

        .driver-info-compact {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .action-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }
    </style>
</head>

<body>

    <nav class="navbar">
        <div class="container nav-content">
            <a href="#" class="logo" style="display:flex; align-items:center; gap:10px; text-decoration:none;">
                <img src="assets/img/logo.png" alt="Logo" style="width:60px; height:60px;">
                <span class="text-gradient" style="font-family: 'Outfit', sans-serif;">Fix<span
                        style="color:white; font-style:italic">Ride</span></span>
            </a>
            <div class="nav-links">
                <a href="index.html" class="btn btn-secondary" style="font-size: 0.8rem;">Logout</a>
            </div>
        </div>
    </nav>

    <div class="container" style="margin-top: 80px;">

        <!-- Live Status Section -->
        <div class="card glass" style="margin-bottom: 2rem;">
            <h3 style="margin-bottom: 1.5rem;">Current Booking Status</h3>

            <div class="status-timeline">
                <div class="status-step">
                    <div class="step-dot active"><ion-icon name="time"></ion-icon></div>
                    <span class="step-label active">Pending</span>
                </div>
                <div class="status-step">
                    <div class="step-dot"><ion-icon name="accessibility"></ion-icon></div>
                    <span class="step-label">Accepted</span>
                </div>
                <div class="status-step">
                    <div class="step-dot"><ion-icon name="construct"></ion-icon></div>
                    <span class="step-label">In Progress</span>
                </div>
                <div class="status-step">
                    <div class="step-dot"><ion-icon name="checkmark"></ion-icon></div>
                    <span class="step-label">Done</span>
                </div>
            </div>

            <!-- Conditional Driver Info -->
            <div id="driver-info" class="driver-info-compact" style="display:none;">
                <div
                    style="width: 50px; height: 50px; background: #555; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                    <ion-icon name="person"></ion-icon>
                </div>
                <div>
                    <div style="font-weight: 700;">Finding Mechanic...</div>
                    <div style="font-size: 0.8rem; color: #888;">Please wait</div>
                </div>
            </div>

            <div id="map-view"
                style="height: 150px; background: #222; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #555; font-weight: bold;">
                [ LIVE MAP VIEW ]
            </div>

            <div id="payment-action"
                style="display:none; text-align:center; margin-top:1rem; padding:1rem; background:rgba(0,255,157,0.1); border-radius:8px;">
                <h4 style="color:var(--color-success); margin-bottom:0.5rem;">Service Completed</h4>
                <p style="font-size:0.9rem; margin-bottom:1rem;">Total Bill: ₹450</p>
                <!-- Direct link to payment.html -->
                <a href="payment.html" class="btn btn-primary"
                    style="display:block; width:100%; background:var(--color-success); text-decoration:none; text-align:center;">Pay
                    Now</a>
            </div>

            <div class="action-grid">
                <button class="btn btn-secondary"
                    style="border-color: var(--color-danger); color: var(--color-danger);">Cancel Booking</button>
                <button id="sim-btn" class="btn btn-primary" onclick="simulateProgress()">⏵ Simulate Progress</button>
            </div>
        </div>

        <!-- Profile Section -->
        <h3>My Profile</h3>
        <div class="card glass">
            <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                <div style="width: 60px; height: 60px; background: #333; border-radius: 50%;"></div>
                <div>
                    <h4>Kavin</h4>
                    <p class="text-muted">+91 98765 43210</p>
                </div>
            </div>
            <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.1); margin: 1rem 0;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                <span>Total Requests</span>
                <span class="text-gradient" style="font-weight: bold;">12</span>
            </div>
        </div>

    </div>

    <!-- Chatbot (Global) -->
    <!-- Chatbot (Global) -->
    <script src="assets/js/app.js"></script>
    <script>
        let currentStep = 0;

        function simulateProgress() {
            currentStep++;

            if (currentStep <= 3) {
                updateStatus(currentStep);
            }

            if (currentStep === 1) { // Accepted
                document.getElementById('driver-info').style.display = 'flex';
                document.getElementById('map-view').innerHTML = '[ LIVE MAP: Mechanic Approaching ]';
            } else if (currentStep === 2) { // In Progress
                document.getElementById('map-view').innerHTML = '[ MECHANIC WORKING ON VEHICLE ]';
                document.getElementById('map-view').style.color = 'var(--color-warning)';
            } else if (currentStep === 3) { // Done
                document.getElementById('map-view').style.display = 'none';
                document.getElementById('payment-action').style.display = 'block';

                // Update button for next step
                const btn = document.getElementById('sim-btn');
                if (btn) {
                    btn.innerHTML = 'Proceed to Payment';
                    btn.classList.add('btn-success'); // Optional: make it green
                }
            } else if (currentStep === 4) { // Redirect
                // Redirect using link click
                const link = document.createElement('a');
                link.href = 'payment.html';
                document.body.appendChild(link);
                link.click();
            }
        }

        function updateStatus(stepIndex) {
            const dots = document.querySelectorAll('.step-dot');
            const labels = document.querySelectorAll('.step-label');

            dots.forEach((d, i) => {
                if (i <= stepIndex) d.classList.add('active');
            });
            labels.forEach((l, i) => {
                if (i <= stepIndex) l.classList.add('active');
            });
        }
    </script>
</body>

</html>